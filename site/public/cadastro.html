<!DOCTYPE html>
<html lang="en">
<!-- Quanto mais cliques mais felicidade damos pra milky-chan, the more you made her happy, more finals of the game you can see -->

<head>
    <link rel="icon" href="imgs/null.png" />
    <link rel="stylesheet" href="css\style.css" />
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milky Site :D</title>
</head>

<body id="Cad_Log">
    <div id="navbar" class="navbar">
        <a href="index.html">
            <img src="imgs/logo.jpg" class="logo">
        </a>
        <a id="anchorNavbar1" href="">Milk Inside </a>
        <a id="anchorNavbar2" href="">Milk Outside</a>
        <a id="anchorNavbar3" href="">Play</a>
        <a id="anchorNavbar4" href="cadastro.html">Sign In </a>
    </div>

    <div class="container_forms">
        <div id="milkGirl" class="milkGirl">
            <span id="milkGirl_text" class="milkGirl_text">
                - Qual seu nome?, espero que você seja mais legal que o outro.
            </span>
        </div>
        <div class="formCad">

            <span class="tipo_campo">Escreva seu nome:</span>
            <input id="nome_input" type="text" placeholder="Ex. Please Don't">

            <span class="tipo_campo">E-mail:</span>
            <input id="email_input" type="text" placeholder="Ex. Make_Fun@of.Me">

            <span class="tipo_campo">Senha:</span>
            <input id="senha_input" type="password" placeholder="********">

            <span class="tipo_campo">Confirme a Senha:</span>
            <input id="confirmacao_senha_input" type="password" placeholder="********">

            <button class="btn" onclick="Cadastrar()">Cadastrar</button>
            <div id="mensagem_erro" class="mensagem_erro">Trad: Faça seu cadastro.</div>
        </div>
    </div>

    <footer class="footer">
        <a href="index.html">
            <img src="imgs/logo.jpg" class="logo">
        </a>
        <div class="footer_texto">
            <span>
                Todos os direitos reservados &copy;Nikita Kryukov
            </span>
        </div>
        <div class="footer_redes">
            <a href="https://github.com/AlyssonAlmeidaSantos">
                <img class="github_icon" src="imgs/github-icon.png">
            </a>
            <a href="https://steamcommunity.com/profiles/76561198795852838/">
                <img class="steam_icon" src="imgs/steam-icon.png">
            </a>
            <a href="https://twitter.com/AIyfilho">
                <img class="twitter_icon" src="imgs/twitter-icon.jpg">
            </a>
        </div>
    </footer>
</body>

</html>

<script>
    function Cadastrar() {
        var nomeVar = nome_input.value;
        var emailVar = email_input.value;
        var senhaVar = senha_input.value;
        var confirmacaoSenhaVar = confirmacao_senha_input.value;

        if (nomeVar == "" || emailVar == "" || senhaVar == "" || confirmacaoSenhaVar == "") {
            mensagem_erro.innerHTML = 'Trad: Preencha todos os campos!';
            milkGirl_text.innerHTML = 'Precisamos de todos eles...';
            milkGirl.style.backgroundImage = 'url(imgs/sad-2.png)';
        } else if (nomeVar.length < 3) {
            mensagem_erro.innerHTML = 'Trad: Seu nome precisa ser maior!';
            milkGirl_text.innerHTML = 'Nunca é o suficiente.';
            milkGirl.style.backgroundImage = 'url(imgs/normal-1.png)';
        } else if (emailVar.indexOf('@') < 1) {
            mensagem_erro.innerHTML = 'Trad: Você esqueceu do @!!';
            milkGirl_text.innerHTML = 'Não me lembro dele.';
            milkGirl.style.backgroundImage = 'url(imgs/sad-2.png)';
        } else if (senhaVar.length < 5) {
            mensagem_erro.innerHTML = 'Trad: Senha muito curta!';
            milkGirl_text.innerHTML = ' Por favor, precisamos de algo melhor!';
            milkGirl.style.backgroundImage = 'url(imgs/normal-1.png)';

        } else if (senhaVar != confirmacaoSenhaVar) {
            mensagem_erro.innerHTML = 'Trad: Você errou as senhas???';
            milkGirl_text.innerHTML = 'Ah pela mor de Deus né.'
            milkGirl.style.backgroundImage = 'url(imgs/normal-2.png)';
        } else {
            milkGirl_text.innerHTML = 'Bem vindo a minha mente ' + varNome + ', obrigada por me ajudar.';
            fetch("/usuarios/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    nomeServer: nomeVar,
                    emailServer: emailVar,
                    senhaServer: senhaVar
                })
            }).then(function(resposta) {

                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    mensagem_erro.innerHTML = "*Cadastro realizado com sucesso! Redirecionando para tela de Login...";

                    setTimeout(() => {
                        window.location = "index.html";
                    }, "2000")

                } else {
                    alert('putamerda')
                    mensagem_erro.innerHTML = '*Oh não';
                    throw ("Houve um erro ao tentar realizar o cadastro!");
                }
            }).catch(function(resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

            return false;

        }
    }
</script>